worker_processes auto;

events { worker_connections 1024; }

# Redis TCP proxy
stream {
    upstream redis_backend {
        server redis-node-1:6379;
        server redis-node-2:6379;
        server redis-node-3:6379;
    }

    server {
        listen 6379;
        proxy_pass redis_backend;
    }
}

# HTTP server for Prometheus scraping
http {
    server {
        listen 8080;

        location /stub_status {
            stub_status;
            access_log off;
        }
    }
}
